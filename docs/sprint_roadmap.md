# Дорожная карта спринтов (инфраструктура и DevEx)

## Этап 1. Пайплайны и конфигурации
- **Цель:** стандартизировать сборку/линт для фронтенда и бэкенда, задать базовые параметры Turborepo.
- **Работы:**
  - Чётко прописать `pipeline` в `turbo.json` с зависимостями `build`/`lint`/`test`.
  - Унифицировать команды в `package.json` workspaces (единые `dev`, `build`, `lint`, `test`).
  - Добавить минимальные конфиги (например, `.npmrc`, кэш-деревья, `tsconfig`/`pyproject`) в репозиторий.
- **Метрики:**
  - Время `npm run build` и `npm run lint` (до/после, фиксированное железо; цель — снижение ≥20% за счёт параллелизма и общих конфигов).
  - Доля повторного использования артефактов Turborepo локально (`turbo run ... --summarize`), целевой hit-rate ≥50% при повторном прогоне без изменений.
  - Стабильность dev-сервера: число рестартов `npm run dev` за 2 часа, целевой показатель — ≤1 спонтанный рестарт.
- **Чекпоинты обратной связи:**
  - Конец первой недели: демо общих команд и список болей команды (опрос в Slack/Notion).
  - Конец спринта: короткое ретро по удобству локальной разработки и скорости.

## Этап 2. CI и remote cache
- **Цель:** ускорить проверки в CI и обеспечить предсказуемость результатов за счёт удалённого кеша.
- **Работы:**
  - Настроить CI-джобы (например, GitHub Actions) для `lint` и `build` с использованием Turborepo.
  - Включить remote cache (Turborepo Remote Cache/другой поставщик) с аутентификацией по ключам/секретам.
  - Добавить контроль «грязного» рабочего дерева (fail, если есть незакешированные артефакты, требующие коммита).
- **Метрики:**
  - Время CI-пайплайна `build`/`lint`: цель — ≥30% ускорение между первым прогоном и повторным прогоном без изменений.
  - Доля кеш-хитов в CI: целевое значение ≥70% для повторных прогонов одной ветки; мониторить `turbo run --summarize`/логи экшенов.
  - Стабильность dev-сервера после интеграции CI-конфигов: отсутствие дополнительных рестартов при локальном `npm run dev` (сравнение с Этапом 1).
- **Чекпоинты обратной связи:**
  - Середина спринта: ревью CI-конфигов с командой (architecture review). 
  - Перед релизом: dry-run CI с фиксацией времени и кеш-хитов, сбор фидбэка у разработчиков по прозрачности логов.

## Этап 3. Инфраструктура и финальная документация
- **Цель:** закрепить инфраструктурные решения, подготовить эксплуатационную документацию и руководства.
- **Работы:**
  - Описать инфраструктуру (Docker Compose/виртуалки/облако), сетевые зависимости и переменные окружения.
  - Добавить playbook: запуск dev-сервера, восстановление после сбоя, прогрев кеша, типовые ошибки.
  - Финализировать документацию по метрикам и регулярным обзорам.
- **Метрики:**
  - Время `build`/`lint` в финальной конфигурации: цель — удержание показателей Этапа 2 или улучшение ещё на 10%.
  - Кеш-хиты: стабильные ≥70% в CI и ≥50% локально; документировать источник данных и частоту просмотра.
  - Стабильность dev-сервера: отсутствие незапланированных рестартов за 4 часа теста (мониторинг логов, локальный запуск).
- **Чекпоинты обратной связи:**
  - Старт спринта: согласование плана документации и инфраструктурных артефактов.
  - Конец спринта: совместное прохождение плейбука + финальная ретроспектива по DevEx и метрикам.

## Общие договорённости по метрикам
- Базовые значения времени `build`/`lint` фиксируются на эталонной машине или runner и публикуются в Notion/README перед изменениями.
- Каждую неделю обновляется дашборд с метриками кеш-хитов и стабильности dev-сервера; SLA обсуждается на weekly-синке.
- Изменения в пайплайнах сопровождаются короткой заметкой в ченджлоге: что поменялось, какой прирост скорости/стабильности.
